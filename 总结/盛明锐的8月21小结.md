[TOC]

# 8/21

## 1.规范八条

```
1、类的构造函数一定要初始化，析构函数
2、区分public，private（可用函数调用）
3、重复出现的代码：长的定义为函数，短的定义成宏
4、函数定义，先检查入参，先做异常处理
5、控制变量：尽量少加
   成员变量：有相关性的成员变量 写成struct
    成员变量太多：考虑合并或者去掉
6、合适的代码或东西放在合适的位置
   代码尽量逻辑简单，不要人为增加复杂度
7、我的代码自己走查一遍，先自己过关
8、阅读代码要留有痕迹，画出流程图或表格
```

## C++小结

1.变量定义须赋初值，指针赋为NULL，防止出现意料之外的错误；

2.指针与数组不同的地方：定义指针不分配空间，不支持如下操作

```c
int *buff;
buff[0] = 1;
```

但数组可以，注意数组空间限制，不要操作越界；

3.尽量使用现成的工具（函数库），避免重复造轮子

## 函数

### 1.strtoul

```c
unsigned long strtoul(const char *nptr,char **endptr,int base);	
//将string转化为unsigned int  
//入参 string起始地址、转换之后该指针表示结束位置、转换规则
```

注：strtol为string转unsigned long

### 2.fopen

```c
FILE *fopen(const char *filename, const char *mode);
//打开文件，返回文件指针
//入参 文件名和、打开方式
//失败返回NULL
```

打开方式：

| **字符串** | **说明**                                                     |
| ---------- | ------------------------------------------------------------ |
| r          | 以只读方式打开文件，该文件必须存在。                         |
| r+         | 以读/写方式打开文件，该文件必须存在。                        |
| rb+        | 以读/写方式打开一个二进制文件，只允许读/写数据。             |
| rt+        | 以读/写方式打开一个文本文件，允许读和写。                    |
| w          | 打开只写文件，若文件存在则文件长度清为零，即该文件内容会消失；若文件不存在则创建该文件。 |
| w+         | 打开可读/写文件，若文件存在则文件长度清为零，即该文件内容会消失；若文件不存在则创建该文件。 |
| a          | 以附加的方式打开只写文件。若文件不存在，则会创建该文件；如果文件存在，则写入的数据会被加到文件尾后，即文件原先的内容会被保留（[EOF](https://baike.baidu.com/item/EOF) 符保留）。 |
| a+         | 以附加方式打开可读/写的文件。若文件不存在，则会创建该文件，如果文件存在，则写入的数据会被加到文件尾后，即文件原先的内容会被保留（EOF符不保留）。 |
| wb         | 以只写方式打开或新建一个二进制文件，只允许写数据。           |
| wb+        | 以读/写方式打开或新建一个二进制文件，允许读和写。            |
| wt+        | 以读/写方式打开或新建一个文本文件，允许读和写。              |
| at+        | 以读/写方式打开一个文本文件，允许读或在文本末追加数据。      |
| ab+        | 以读/写方式打开一个二进制文件，允许读或在文件末追加数据。    |

### 3. fseek

```c
int fseek(FILE *stream, long offset, int fromwhere)	
//函数设置文件指针stream的位置。
```

 如果执行成功，stream将指向以fromwhere为基准，偏移offset（指针偏移量）个字节的位置，函数返回0。如果执行失败(比如offset取值大于等于2*1024*1024*1024，即long的正数范围2G)，则不改变stream指向的位置，[函数](https://baike.baidu.com/item/函数/18686609)返回一个非0值。 

注：文件需要已经打开。

## 编程遇到的问题及解决

1.头文件链接失败

解决：linux下链接头文件 https://www.cnblogs.com/xpylovely/p/11171135.html 

2.利用libxml生成xml文件默认生成xml为一行

解决：

```c
xmlKeepBlanksDefault(0);
xmlIndentTreeOutput = 1;	//打开设置开关
int nRel = xmlSaveFormatFile("test.xml",doc, 1);	//输出格式设置成1
//还可以使用函数xmlSaveFormatFileEnc或xmlSaveFormatFileTo设置
```

3.GCC编译程序出现 `undefined reference to 'std::ios_base::Init::Init()'`问题

解决： Linux下面采用gcc 编译 c++的代码第一需要安装gcc-c++支持库，其次编译的时候需要添加参数 -lstdc++。 